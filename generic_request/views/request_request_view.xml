<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_request_request_form" model="ir.ui.view">
        <field name="model">request.request</field>
        <field name="arch" type="xml">
            <form create="0">
                <field invisible="1" name="id"/>
                <field invisible="1" name="use_timesheet"/>
                <field invisible="1" name="timesheet_start_status"/>
                <field invisible="1" name="closed"/>
                <field invisible="1" name="can_be_closed"/>
                <field invisible="1" name="is_new_request"/>
                <field invisible="1" name="can_change_assignee"/>
                <field invisible="1" name="can_change_request_text"/>
                <field invisible="1" name="can_change_author"/>
                <field invisible="1" name="can_change_category"/>
                <field invisible="1" name="can_change_deadline"/>
                <!-- <field name="type_code" invisible="1"/> -->
                <field invisible="1" name="is_market_place_request"/>
                <header>
<!--                    <div class="stage_route_out_widget">-->
<!--                        <field name="stage_route_out_json" widget="stage_route_out_widget"/>-->
<!--                    </div>-->
                    <!--                    <field name="stage_id" widget="statusbar"-->
                    <!--                           required="0"-->
                    <!--                           attrs="{'readonly': True}"-->
                    <!--                           domain="[('id', '=', stage_id)]"/>-->
                    <!-- <field name="stage_id" widget="statusbar" clickable="1"
                           required="0"
                           domain="[('request_type_id', '=', type_id)]"/> -->
                    <!--                    <field name="stage_type_id" widget="statusbar" options="{'clickable': '1'}"-->
                    <!--                           domain="[('is_market_place', '=', is_market_place_request)]"/>-->
                    <field invisible="1" name="request_stage_ids"/>
                    <field domain="[('id', 'in', request_stage_ids)]" name="stage_type_id" options="{'clickable': '1'}" widget="statusbar"/>
                    <field invisible="1" name="stage_type_code"/>
                    <!-- <field name="stage_type_id" widget="statusbar" options="{'clickable': '1'}" domain="[('is_market_place', '=', True)]" attrs="{'invisible': [('type_code', '!=', 'infinity-order')]}"/> -->
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" icon="fa-sitemap" name="action_button_show_subrequests" type="object">
                            <field name="child_count" string="Subrequests" widget="statinfo"/>
                        </button>
                        <button class="oe_stat_button" icon="fa-rocket" name="action_view_formio" string="Ticket Form" type="object"/>
                    </div>
                    <div class="oe_title request_title" name="title">
                        <div style=" display: flex; align-items: center;">
                            <!--                            <div class="mr16" attrs="{'invisible': [('is_priority_complex', '=', False)]}">-->
                            <!--                                <div>-->
                            <!--                                    <span class="field-icon fa fa-star-half-empty oe_inline"-->
                            <!--                                        title="Impact"-->
                            <!--                                        aria-label="Impact"-->
                            <!--                                        style="margin-right: 12px;"/>-->
                            <!--                                    <field name="impact" widget="priority" class="mb0"/>-->
                            <!--                                </div>-->
                            <!--                                <div>-->
                            <!--                                    <span class="field-icon fa fa-clock-o oe_inline"-->
                            <!--                                        title="Urgency"-->
                            <!--                                        aria-label="Urgency"-->
                            <!--                                        style="margin-right: 12px;"/>-->
                            <!--                                    <field name="urgency" widget="priority"/>-->
                            <!--                                </div>-->
                            <!--                            </div>-->
                            <!--                            <div>-->
                            <!--                                <span class="fa fa-arrow-right mr16"-->
                            <!--                                      title="Urgency and Impact converted to Priority"-->
                            <!--                                      attrs="{'invisible': ['|', ('is_priority_complex', '=', False), ('id', '=', False)]}"/>-->
                            <!--                                <field name="is_priority_complex" invisible="1"/>-->
                            <!--                                <label for="priority" string="Priority"/> <br/>-->
                            <!--                                <field name="priority"-->
                            <!--                                    attrs="{'readonly': [('is_priority_complex', '=', True)]}"-->
                            <!--                                />-->
                            <!--                            </div>-->
                        </div>
                        <h2 name="header_name">
                            <span invisible="parent_id == False">
                                <field name="parent_id" placeholder="Parent..."/>
                                <span class="ml4 mr4">
                                    /
                                </span>
                            </span>
                            <field name="name"/>
                            <field class="request-kanban-state ml8" name="kanban_state" widget="state_selection"/>
                        </h2>
                        <strong>
                            <field invisible="1" name="summary" nolabel="1" style="width: 100%"/>
                        </strong>
                    </div>
                    <group class="request-head-info" name="request_head_info">
                        <group class="request-head-info-left" name="request_head_info_left">
                            <div class="request-head-info-item" colspan="2" name="header_category">
                                <label for="category_id" string="Ticket Category"/>
                                <span class="field-with-icon">
                                    <span aria-label="Category" class="field-icon fa fa-bars oe_inline" title="Category"/>
                                    <field class="oe_inline" domain="['|', (is_new_request, '=', 1), ('request_type_ids', '=', type_id)]" name="category_id" options="{'no_create': true, 'no_quick_create': true}" placeholder="Category..." readonly="id != False and can_change_category == False" required="1"/>
                                </span>
                            </div>
                            <div class="request-head-info-item" colspan="2" name="header_type">
                                <label for="type_id" string="Ticket Type"/>
                                <span class="field-with-icon">
                                    <span aria-label="Type" class="field-icon fa fa-hashtag oe_inline" title="Type"/>
                                    <field class="oe_inline" domain="[('start_stage_id', '!=', False), ('category_ids', '=', category_id)]" name="type_id" options="{'no_create': true, 'no_quick_create': true}" placeholder="Type..." readonly="id != False"/>
                                </span>
                            </div>
                            <div class="request-head-info-item" colspan="2" name="header_kind">
                                <span class="field-with-icon" invisible="kind_id == False">
                                    <span aria-label="Kind" class="field-icon fa fa-square oe_inline" title="Kind"/>
                                    <field class="oe_inline" name="kind_id" options="{'no_create': true, 'no_quick_create': true}" placeholder="Kind..."/>
                                </span>
                            </div>
                        </group>
                        <group class="request-head-info-right" name="request_head_info_right">
                            <div class="request-head-info-item" colspan="2" invisible="use_timesheet == False" name="header_time_tracking">
                                <span class="field-with-icon">
                                    <span class="field-icon fa fa-hourglass-end oe_inline" title="Tracked time"/>
                                    <field class="w_auto" invisible="timesheet_planned_amount == 0" name="timesheet_progress" string="Progress" widget="progressbar"/>
                                    <field class="oe_inline w_auto mr4 ml4" name="timesheet_amount" widget="float_time"/>
                                    of
                                    <field class="oe_inline w_auto mr4 ml4 request-timesheet-planned-amount" name="timesheet_planned_amount" widget="float_time"/>
                                    Hours
                                    <span class="request-timesheet-splitter" invisible="timesheet_planned_amount != 0"/>
                                    <button class="btn-sm btn-success ml4" icon="fa-play" invisible="timesheet_start_status == 'started'" name="action_start_work" title="Start" type="object"/>
                                    <button class="btn-sm btn-warning ml4" icon="fa-stop" invisible="timesheet_start_status == 'not-started' or id == False" name="action_stop_work" title="Stop" type="object"/>
                                </span>
                            </div>
                            <div class="request-head-info-item" colspan="2" invisible="0" name="header_deadline">
                                <field invisible="1" name="deadline_state"/>
                                <label for="deadline_date" string="Deadline Date"/>
                                <span class="field-with-icon">
                                    <span class="field-icon fa fa-clock-o text-success oe_inline" invisible="deadline_state != 'ok'" title="Deadline"/>
                                    <span class="field-icon fa fa-clock-o text-warning oe_inline" invisible="deadline_state != 'today'" title="Deadline"/>
                                    <span class="field-icon fa fa-clock-o text-danger oe_inline" invisible="deadline_state != 'overdue'" title="Deadline"/>
                                    <span class="field-icon fa fa-clock-o oe_inline" invisible="deadline_state != False" title="Deadline"/>
                                    <field class="oe_inline" name="deadline_date" readonly="can_change_deadline == False"/>
                                </span>
                            </div>
                            <div class="request-head-info-item" colspan="2" invisible="1" name="header_tags">
                                <span class="field-with-icon">
                                    <span class="field-icon fa fa-tags oe_inline" title="Tags"/>
                                    <field class="oe_inline" context="{'default_model': 'request.request'}" domain="[('model_id.model', '=', 'request.request'),'|', ('category_id', '=', False), ('category_id.request_type_ids.id', '=', type_id)]" name="tag_ids" options="{'color_field': 'color'}" placeholder="Tags..." widget="many2many_tags"/>
                                </span>
                            </div>
                        </group>
                    </group>
                    <notebook class="request-notebook">
                        <page name="page_request" string="Request">
                            <field invisible="note_html == False or id != False" name="note_html"/>
                            <div class="request-separator request-separator-info" invisible="note_html == False or id != False">
                                <span class="request-separator-text">
                                    Info
                                </span>
                            </div>
                            <div class="request-separator request-separator-request-response" invisible="is_routine_ticket_type == False" name="request_routine_separator">
                                <span class="request-separator-text">
                                    Routine Details
                                </span>
                            </div>
                            <group col="2" invisible="is_routine_ticket_type == False">
                                <group>
                                    <field name="auto_routine_site_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True}" required="is_routine_ticket_type == True"/>
                                    <field invisible="stage_type_code in ['new', 'previsit']" name="auto_routine_site_access"/>
                                </group>
                                <group>
                                    <field name="auto_routine_engineer_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True}"/>
                                    <field name="auto_routine_site_wo" required="is_routine_ticket_type == True"/>
                                </group>
                            </group>
                            <group class="mb0" invisible="1" name="group_author">
                                <group class="mb0 mt0">
                                    <label for="author_id"/>
                                    <div class="request-partner-author-field o_row" name="div_author">
                                        <field name="author_id" options="{'info_method': 'request_helper_m2o_info'}" placeholder="Author..." readonly="can_change_author == False" widget="m2o_info"/>
                                        <span name="span_request_author_stat">
                                            <button class="btn btn-sm btn-secondary" invisible="author_id == False or author_related_request_open_count != 0" name="action_show_related_author_requests_opened" title="Open requests by same author" type="object">
                                                <field name="author_related_request_open_count"/>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" invisible="author_id == False or author_related_request_open_count == 0" name="action_show_related_author_requests_opened" title="Open requests by same author" type="object">
                                                <field name="author_related_request_open_count"/>
                                            </button>
                                            <button class="btn btn-sm btn-secondary btn-outline-dark ml4" invisible="author_id == False" name="action_show_related_author_requests_closed" title="Closed requests by same author" type="object">
                                                <field name="author_related_request_closed_count"/>
                                            </button>
                                        </span>
                                    </div>
                                    <field invisible="author_id != False or author_name == False" name="author_name"/>
                                    <field invisible="author_id != False or author_phone == False" name="author_phone"/>
                                </group>
                                <group class="mb0 mt0" name="group_partner">
                                    <label for="partner_id"/>
                                    <div class="request-partner-author-field o_row" name="div_partner">
                                        <field name="partner_id" options="{'info_method': 'request_helper_m2o_info'}" placeholder="Related partner..." widget="m2o_info"/>
                                        <span name="span_request_partner_stat">
                                            <button class="btn btn-sm btn-secondary" invisible="partner_id == False or partner_related_request_open_count != 0" name="action_show_related_partner_requests_opened" title="Open requests by same partner" type="object">
                                                <field name="partner_related_request_open_count"/>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" invisible="partner_id == False or partner_related_request_open_count == 0" name="action_show_related_partner_requests_opened" title="Open requests by same partner" type="object">
                                                <field name="partner_related_request_open_count"/>
                                            </button>
                                            <button class="btn btn-sm btn-secondary btn-outline-dark ml4" invisible="partner_id == False" name="action_show_related_partner_requests_closed" title="Closed requests by same partner" type="object">
                                                <field name="partner_related_request_closed_count"/>
                                            </button>
                                        </span>
                                    </div>
                                </group>
                            </group>
                            <div class="request-separator request-separator-request-text mb8" name="request_text_separator">
                                <span class="request-separator-text"/>
                            </div>
                            <field colspan="4" name="request_text" readonly="(id != False and (closed == True or can_change_request_text == False))" widget="request_html"/>
                            <div class="request-separator request-separator-request-response" invisible="response_text == False" name="request_response_separator">
                                <span class="request-separator-text">
                                    Response
                                </span>
                            </div>
                            <field colspan="4" invisible="response_text == False" name="response_text" readonly="1" widget="request_html"/>
                            <field invisible="1" name="is_routine_ticket_type"/>
                        </page>
                        <page invisible="use_timesheet == False" string="Time log">
                            <field name="timesheet_line_ids"><tree editable="bottom">
                                    <field invisible="1" name="date_start" readonly="1"/>
                                    <field invisible="1" name="date_end" readonly="1"/>
                                    <field name="activity_id" required="1"/>
                                    <field name="date"/>
                                    <field name="user_id"/>
                                    <field name="description"/>
                                    <field name="amount" required="1" string="Duration (Hours)" sum="Total Duration (Hours)" widget="float_time"/>
                                </tree></field>
                            <group class="mt0" name="group_time_log_footer">
                                <group class="oe_subtotal_footer oe_right mt0">
                                    <field name="timesheet_amount" readonly="1" widget="float_time"/>
                                    <field class="oe_subtotal_footer_separator" name="timesheet_remaining_amount" readonly="1" widget="float_time"/>
                                </group>
                            </group>
                        </page>
                        <page name="checklist" string="Checklist">
                            <field invisible="1" name="stage_id"/>
                            <button class="btn-secondary" name="update_checklists" string="Update Checklist" type="object"/>
                            <field name="checklist_ids"><tree create="0" editable="bottom">
                                    <field name="done" string="Done?" widget="checkbox"/>
                                    <field name="name" readonly="1" string="Task"/>
                                    <field invisible="1" name="stage_from_id"/>
                                    <field invisible="1" name="stage_to_id"/>
                                </tree></field>
                        </page>
<!--                        <page invisible="((help_html == False or help_html == '<p><br></p>') and (stage_help_html == False or stage_help_html == '<p><br></p>')) and (category_help_html == False or category_help_html == '<p><br></p>')" name="page_help" string="Help">-->
<!--                            <separator colspan="4" invisible="stage_help_html == False or stage_help_html == '<p><br></p>'" string="Stage"/>-->
<!--                            <field colspan="4" invisible="stage_help_html == False or stage_help_html == '<p><br></p>'" name="stage_help_html"/>-->
<!--                            <separator colspan="4" invisible="category_help_html == False or category_help_html == '<p><br></p>'" string="Category"/>-->
<!--                            <field colspan="4" invisible="category_help_html == False or category_help_html == '<p><br></p>'" name="category_help_html"/>-->
<!--                            <separator colspan="4" invisible="help_html == False or help_html == '<p><br></p>'" string="Type"/>-->
<!--                            <field colspan="4" invisible="help_html == False or help_html == '<p><br></p>'" name="help_html"/>-->
<!--                        </page>-->
                        <page invisible="instruction_visible == False" name="page_instruction" string="Instruction">
                            <field invisible="1" name="instruction_visible"/>
                            <field colspan="4" name="instruction_html"/>
                        </page>
                        <page name="page_other" string="Other">
                            <group>
                                <group name="group_info_left">
                                    <field invisible="1" name="is_priority_complex"/>
                                    <field name="priority" readonly="is_priority_complex == True"/>
                                    <field name="impact"/>
                                    <field name="urgency"/>
                                    <field name="partner_id"/>
                                    <field name="email_from"/>
                                    <field name="email_cc"/>
                                    <field name="channel_id" widget="many2one"/>
                                    <field name="parent_id"/>
                                    <field name="ticket_type"/>
                                    <field invisible="0" name="form_id"/>
                                    <field name="submission_instance"/>
                                    <field name="submission_email"/>
                                    <field name="jira_url" widget="url"/>
                                    <field name="asana_url" widget="url"/>
                                    <field name="ticket_link" style="font-size: 1.0em;" widget="CopyClipboardChar"/>
                                    <field invisible="1" name="remote_ticket_id"/>
                                    <field invisible="remote_ticket_id == 0" name="remote_ticket_link" style="font-size: 1.0em;" widget="CopyClipboardChar"/>
                                    <field invisible="1" name="submission_company"/>
                                </group>
                                <group name="group_info_right"/>
                            </group>
                        </page>
                        <page groups="base.group_no_one" name="page_technical" string="Technical">
                            <group>
                                <group col="1" name="group_tech_links">
                                    <button class="oe_link" groups="generic_request.group_request_manager" icon="fa-bell" name="action_show_request_events" type="object">
                                        <field name="request_event_count" string="Request Events" widget="statinfo"/>
                                    </button>
                                </group>
                            </group>
                        </page>
                    </notebook>
                    <div class="row mt8" name="request_user_info_footer">
                        <div class="col-md-12">
                            <p>
                                For attachments please click the Paperclip below
                            </p>
                        </div>
                        <div class="col-md-3" name="request_footer__creator">
                            <div>
                                <label for="date_created" string="Created"/>
                            </div>
                            <div>
                                <i class="fa fa-calendar mr4" title="Date Created"/>
                                <field name="date_created"/>
                            </div>
                            <div>
                                <i class="fa fa-user mr4" title="Created by user"/>
                                <field class="d-inline-block" name="created_by_id" options="{'info_method': 'request_helper_m2o_info'}" widget="m2o_info"/>
                            </div>
                        </div>
                        <div class="col-md-3" invisible="date_moved == False" name="request_footer__moved_by">
                            <div>
                                <label for="date_moved" string="Moved"/>
                            </div>
                            <div>
                                <i class="fa fa-calendar mr4" title="Date Created"/>
                                <field name="date_moved"/>
                            </div>
                            <div>
                                <i class="fa fa-user mr4" title="Moved by user"/>
                                <field class="d-inline-block" name="moved_by_id" options="{'info_method': 'request_helper_m2o_info'}" widget="m2o_info"/>
                            </div>
                        </div>
                        <div class="col-md-3" name="request_footer__assigned">
                            <div>
                                <span invisible="user_id == False">
                                    <label for="date_assigned" string="Assigned"/>
                                </span>
                                <span invisible="closed == True or can_change_assignee == False or user_id != False or id == False" name="request_assign_button">
                                    <button class="oe_link" name="action_request_assign" string="Assign" style="padding: 0px 0px;" type="object"/>
                                </span>
                                <span invisible="can_change_assignee == False or user_id == False" name="request_reassign_button">
                                    <button class="oe_link" name="action_request_assign" string="Reassign" style="padding: 0px 0px;" type="object"/>
                                </span>
                            </div>
                            <div invisible="user_id != False">
                                <button class="oe_link" invisible="closed == True or can_change_assignee == False or user_id != False or id == False" name="action_request_assign_to_me" string="Assign to me" style="padding: 0px 0px;" type="object"/>
                            </div>
                            <div>
                                <i class="fa fa-calendar mr4" invisible="date_assigned == False" title="Date Assigned"/>
                                <field name="date_assigned"/>
                            </div>
                            <div invisible="user_id == False">
                                <i class="fa fa-user mr4" title="Assignee"/>
                                <field class="d-inline-block" name="user_id" options="{'info_method': 'request_helper_m2o_info'}" readonly="1" widget="m2o_info"/>
                            </div>
                        </div>
                        <div class="col-md-3" invisible="date_closed == False" name="request_footer__closed">
                            <div>
                                <label for="date_closed" string="Closed"/>
                            </div>
                            <div>
                                <i class="fa fa-calendar mr4" title="Date Closed"/>
                                <field name="date_closed"/>
                            </div>
                            <div>
                                <i class="fa fa-user mr4" title="Closed by user"/>
                                <field class="d-inline-block" name="closed_by_id" options="{'info_method': 'request_helper_m2o_info'}" widget="m2o_info"/>
                            </div>
                        </div>
                    </div>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form></field>
    </record>
    <record id="view_request_request_tree" model="ir.ui.view">
        <field name="model">request.request</field>
        <field name="arch" type="xml">
            <tree create="0" decoration-bf="message_needaction==True" decoration-danger="request_state == 'overdue'" decoration-info="request_state=='today'" decoration-success="closed == True" default_order="date_created desc">
                <field column_invisible="True" name="message_needaction"/>
                <field column_invisible="True" name="request_state"/>
                <field column_invisible="True" name="closed"/>
                <field column_invisible="True" name="is_priority_complex"/>
                <field column_invisible="True" name="stage_bg_color"/>
                <field column_invisible="True" name="stage_label_color"/>
                <field name="name"/>
                <field name="type_id" optional="show"/>
                <field name="category_id" optional="show"/>
                <field name="parent_id" optional="hide"/>
                <field name="author_id" optional="show"/>
                <field name="user_id" optional="show"/>
                <field name="partner_id" optional="show"/>
                <field name="summary" optional="show" options="{'max_width': '350px', 'line_clamp': '3'}" string="Summary" widget="dynamic_popover_text"/>
                <field name="date_created" optional="show"/>
                <field name="date_closed" optional="hide"/>
                <field name="deadline_date" optional="hide" string="Deadline"/>
                <field name="stage_id" optional="show" options="{'field_bg_color': 'stage_bg_color', 'field_label_color': 'stage_label_color'}"/>
                <field name="kanban_state" optional="hide" widget="state_selection"/>
                <field context="{'default_model': 'request.request'}" name="tag_ids" optional="hide" options="{'color_field': 'color'}" placeholder="Tags..." widget="many2many_tags"/>
                <field column_invisible="True" name="use_timesheet"/>
                <field column_invisible="True" name="timesheet_start_status"/>
                <field name="stage_due_date" optional="hide"/>
                <button class="text-success" icon="fa-play-circle" invisible="use_timesheet == False or timesheet_start_status == 'started'" name="action_start_work" string="Start" type="object"/>
                <button class="text-warning" icon="fa-stop-circle" invisible="use_timesheet == False or timesheet_start_status == 'not-started'" name="action_stop_work" string="Stop" type="object"/>
                <field name="priority" optional="show" readonly="is_priority_complex == True" widget="priority"/>
            </tree></field>
    </record>
    <record id="view_request_request_kanban" model="ir.ui.view">
        <field name="model">request.request</field>
        <field name="arch" type="xml">
            <kanban default_group_by="stage_type_id" delete="false" edit="false" group_create="false" group_delete="false" group_edit="false" quick_create="false">
                <field name="name"/>
                <field name="use_timesheet"/>
                <field name="timesheet_start_status"/>
                <field name="type_id"/>
                <field name="type_color"/>
                <field name="kind_id"/>
                <field name="category_id"/>
                <field name="created_by_id"/>
                <field name="user_id"/>
                <field name="date_created"/>
                <field name="date_assigned"/>
                <field name="date_closed"/>
                <field name="closed_by_id"/>
                <field name="closed"/>
                <field name="stage_id"/>
                <field name="stage_bg_color"/>
                <field name="stage_label_color"/>
                <field name="summary"/>
                <field name="activity_ids"/>
                <field name="activity_state"/>
                <field name="partner_id"/>
                <field name="author_id"/>
                <field name="deadline_date"/>
                <field name="deadline_state"/>
                <field name="kanban_state"/>
                <field name="parent_id"/>
                <field name="child_count"/>
                <field name="message_follower_ids"/>
                <field name="message_discussion_ids"/>
                <field name="message_needaction"/>
                <field name="message_needaction_counter"/>
                <field name="request_state"/>
                <progressbar colors='{"normal": "success", "today": "warning", "overdue": "danger"}' field="request_state"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_global_click o_request_kanban" t-att-style="record.closed.raw_value ? 'background-color:rgba(242,242,242,1)' : 'rgba(255,255,255,1)'">
                            <div class="o_request_kanban_header" name="header" t-attf-style="background-color: {{record.type_color.raw_value}}">
                                <div class="o_header_title_box" name="title_box">
                                    <div class="o_header_box_item" t-if="record.parent_id.value">
                                        <a name="action_open_parent" type="object">
                                            <span>
                                                <field name="parent_id"/>
                                                <span>
                                                    /
                                                </span>
                                            </span>
                                        </a>
                                    </div>
                                    <div class="o_header_title o_header_box_item" name="title">
                                        <span>
                                            <field name="name"/>
                                        </span>
                                    </div>
                                    <div class="o_header_title o_header_box_item" name="activities_box">
                                        <span>
                                            <field name="activity_ids" widget="kanban_activity"/>
                                        </span>
                                    </div>
                                    <div class="o_header_box_item">
                                        <a class="fa fa-lg fa-play-circle text-success" invisible="use_timesheet == False or timesheet_start_status == 'started'" name="action_start_work" title="Start" type="object"/>
                                        <a class="fa fa-lg fa-stop-circle text-warning" invisible="use_timesheet == False or timesheet_start_status == 'not-started'" name="action_stop_work" title="Stop" type="object"/>
                                    </div>
                                    <div class="o_header_box_item" name="priority_box">
                                        <field invisible="True" name="is_priority_complex"/>
                                        <field name="priority" readonly="is_priority_complex == True" widget="priority"/>
                                    </div>
                                </div>
                                <div class="o_header_icons_info" name="icons_info">
                                    <span class="icon" t-if="record.message_needaction.raw_value">
                                        <span class="fa fa-comments mr4" title="Messages"/>
                                        <span style="font-weight: bold" title="You have unread messages related to this request.">
                                            <t t-esc="record.message_needaction_counter.raw_value"/>
                                        </span>
                                    </span>
                                    <span class="icon" t-if="record.message_follower_ids.raw_value">
                                        <span class="fa fa-users mr4" title="Followers"/>
                                        <t t-esc="record.message_follower_ids.raw_value.length"/>
                                    </span>
                                    <span class="icon" t-if="record.child_count.raw_value">
                                        <span class="fa fa-sitemap mr4" title="Subrequests"/>
                                        <t t-esc="record.child_count.raw_value"/>
                                    </span>
                                </div>
                                <div class="o_header_right_info" name="right_info">
                                    <div name="right_info_kanban_state">
                                        <field name="kanban_state" widget="state_selection"/>
                                    </div>
                                    <div class="o_header_stage" name="right_info_stage" t-attf-style="background-color: {{record.stage_bg_color.raw_value}}">
                                        <span t-attf-style="color: {{record.stage_label_color.raw_value}}">
                                            <field name="stage_id"/>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="request_kanban_tags">
                                <field name="tag_ids" options="{'color_field': 'color'}" widget="request_tag"/>
                            </div>
                            <div class="o_request_kanban_content">
                                <div class="o_request_kanban_info o_request_kanban_row">
                                    <div class="o_request_kanban_info_left" name="request_kanban_info_left">
                                        <div>
                                            <span class="text-muted" title="Category">
                                                <span class="fa fa-bars mr4"/>
                                                <t t-if="record.category_id.raw_value">
                                                    <field name="category_id"/>
                                                </t>
                                                <!-- <t t-if="!record.category_id.raw_value">
                                                    <span>Undefined</span>
                                                </t> -->
                                            </span>
                                        </div>
                                        <div>
                                            <span class="text-muted" title="Type">
                                                <span class="fa fa-hashtag mr4"/>
                                                <field name="type_id"/>
                                            </span>
                                        </div>
                                        <!-- <div>
                                            <span class="text-muted" title="Kind">
                                                <span class="fa fa-square mr4"/>
                                                <t t-if="record.kind_id.raw_value">
                                                    <field name="kind_id"/>
                                                </t>
                                                <t t-if="!record.kind_id.raw_value">
                                                    <span>Undefined</span>
                                                </t>
                                            </span>
                                        </div> -->
                                    </div>
                                    <div class="o_request_kanban_info_right" name="request_kanban_info_right">
                                        <div t-if="record.deadline_date.raw_value">
                                            <span class="text-muted" title="Deadline">
                                                <span class="text-success fa fa-clock-o mr4" t-if="record.deadline_state.raw_value == 'ok'"/>
                                                <span class="text-warning fa fa-clock-o mr4" t-if="record.deadline_state.raw_value == 'today'"/>
                                                <span class="text-danger fa fa-clock-o mr4" t-if="record.deadline_state.raw_value == 'overdue'"/>
                                                <field name="deadline_date"/>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="o_request_kanban_row">
                                    <!--                              <div class="o_partner_icon mr8">-->
                                    <!--                                <t t-if="record.partner_id.raw_value">-->
                                    <!--                                    <div>-->
                                    <!--                                        <a type="open">-->
                                    <!--                                            <img t-att-src="kanban_image('res.partner', 'image_128', record.partner_id.raw_value)"-->
                                    <!--                                                 t-att-title="record.partner_id.value"-->
                                    <!--                                                 t-att-alt="record.partner_id.value"-->
                                    <!--                                                 class="oe_kanban_image"/>-->
                                    <!--                                        </a>-->
                                    <!--                                    </div>-->
                                    <!--                                </t>-->
                                    <!--                             </div>-->
                                    <div>
                                        <div class="o_request_kanban_text" name="request_text">
                                            <div>
                                                <field name="summary"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="o_request_kanban_dates o_request_kanban_row" name="dates">
                                    <div class="o_date" t-att-title="'Created by\n' + record.author_id.value + '\n' + record.date_created.value">
                                        <t t-if="record.author_id.raw_value">
                                            <a type="open">
                                                <img class="oe_kanban_image" t-att-alt="record.author_id.value" t-att-src="kanban_image('res.partner', 'image_128', record.author_id.raw_value)"/>
                                            </a>
                                            <strong>
                                                <field name="author_id"/>
                                            </strong>
                                            <div class="oe_kanban_hidden_text">
                                                <field name="date_created"/>
                                            </div>
                                        </t>
                                    </div>
                                    <div class="o_date" t-att-title="'Assigned to\n' + record.user_id.value + '\n' + record.date_assigned.value">
                                        <t t-if="record.user_id.raw_value">
                                            <a type="open">
                                                <img class="oe_kanban_image" t-att-alt="record.user_id.value" t-att-src="kanban_image('res.users', 'image_128', record.user_id.raw_value)"/>
                                            </a>
                                            <strong>
                                                <field name="user_id"/>
                                            </strong>
                                            <div class="oe_kanban_hidden_text">
                                                <field name="date_assigned"/>
                                            </div>
                                        </t>
                                    </div>
                                    <!--                                    <div class="o_date"-->
                                    <!--                                         t-att-title="'Closed by\n' + record.closed_by_id.value + '\n' + record.date_closed.value">-->
                                    <!--                                        <t t-if="record.closed_by_id.raw_value">-->
                                    <!--                                            <a type="open">-->
                                    <!--                                                <img t-att-src="kanban_image('res.users', 'image_128', record.closed_by_id.raw_value)"-->
                                    <!--                                                     t-att-alt="record.closed_by_id.value"-->
                                    <!--                                                     class="oe_kanban_image"/>-->
                                    <!--                                            </a>-->
                                    <!--                                            <strong>-->
                                    <!--                                                <field name="closed_by_id"/>-->
                                    <!--                                            </strong>-->
                                    <!--                                            <div class="oe_kanban_hidden_text">-->
                                    <!--                                                 <field name="date_closed"/>-->
                                    <!--                                            </div>-->
                                    <!--                                        </t>-->
                                    <!--                                    </div>-->
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban></field>
    </record>
    <record id="view_request_request_search" model="ir.ui.view">
        <field name="model">request.request</field>
        <field name="arch" type="xml">
            <search>
                <field filter_domain="['|', '|', '|', '|', '|', '|', '|',                        ('name', 'ilike', self),                        ('request_text', 'ilike', self),                        ('author_id.phone', 'ilike', self),                        ('author_id.mobile', 'ilike', self),                        ('author_id.name', 'ilike', self),                        ('partner_id.phone', 'ilike', self),                        ('partner_id.mobile', 'ilike', self),                        ('partner_id.name', 'ilike', self)]" name="display_name" string=""/>
                <field name="name"/>
                <field name="type_id"/>
                <field name="parent_id"/>
                <field name="kind_id"/>
                <field name="category_id"/>
                <field name="stage_type_id"/>
                <field name="partner_id"/>
                <field name="author_id"/>
                <field name="user_id"/>
                <field name="is_assigned"/>
                <field name="closed"/>
                <field name="tag_ids"/>
                <field name="search_tag_id"/>
                <field name="search_no_tag_id"/>
                <field filter_domain="['|', ('message_ids.body', 'ilike', self), ('message_ids.subject', 'ilike', self)]" name="message_ids"/>
                <filter domain="[('active', '=', False)]" name="filter_archived" string="Archived"/>
                <filter domain="[('active', '=', True)]" name="filter_active" string="Active"/>
                <separator/>
                <filter domain="[('closed', '=', True)]" name="filter_closed" string="Closed"/>
                <separator/>
                <filter domain="[('closed', '=', False)]" name="filter_open" string="Open"/>
                <separator/>
                <filter domain="[('user_id', '=', False)]" name="filter_unassigned" string="Unassigned"/>
                <filter domain="[('user_id', '=', uid)]" name="filter_assigned_to_me" string="Assigned to me"/>
                <filter domain="[('created_by_id', '=', uid)]" name="filter_created_by_me" string="My requests"/>
                <separator/>
                <filter domain="[('request_state', '=', 'overdue')]" name="filter_overdue" string="Overdue"/>
<!--                <filter domain="[('date_created', '>', (context_today() - relativedelta(days=1)).strftime('%%Y-%%m-%%d') )]" name="filter_today" string="Today"/>-->
<!--                <filter domain="[('date_created', '>', (datetime.datetime.now() - relativedelta(days=1)).strftime('%%Y-%%m-%%d %H:%M:%S') )]" name="filter_24h" string="24 hours"/>-->
<!--                <filter domain="[('date_created', '>', (context_today() - relativedelta(weeks=1)).strftime('%%Y-%%m-%%d') )]" name="filter_week" string="Week"/>-->
<!--                <filter domain="[('date_created', '>', (context_today() - relativedelta(months=1)).strftime('%%Y-%%m-%%d') )]" name="filter_month" string="Month"/>-->
<!--                <filter domain="[('date_created', '>', (context_today() - relativedelta(years=1)).strftime('%%Y-%%m-%%d') )]" name="filter_year" string="Year"/>-->
<!--                <separator/>-->
<!--                <filter domain="[('stage_due_date', '<', datetime.datetime.now() )]" name="filter_sla_violated" string="SLA Violated"/>-->
<!--                <filter domain="[('stage_due_date', '>', datetime.datetime.now() )]" name="filter_sla_not_violated" string="SLA Not Violated"/>-->
                <separator/>
                <filter domain="[('message_needaction','=',True)]" name="message_needaction" string="Unread Messages"/>
                <separator/>
                <filter domain="[('parent_id', '!=', False)]" name="is_subrequest" string="Is Subrequest"/>
                <filter domain="[('parent_id', '=', False)]" name="not_subrequest" string="Not Subrequest"/>
                <filter domain="[('child_ids', '!=', False)]" name="has_subrequest" string="Has Subrequests (Epics)"/>
                <group expand="0" name="group_group_by" string="Group by...">
                    <filter context="{'group_by': 'date_created'}" name="filter_group_by_creation_date" string="Creation date"/>
                    <filter context="{'group_by': 'type_id'}" name="filter_group_by_type" string="Type"/>
                    <filter context="{'group_by': 'kind_id'}" name="filter_group_by_kind" string="Kind"/>
                    <filter context="{'group_by': 'category_id'}" name="filter_group_by_category" string="Category"/>
                    <!-- <filter name="filter_group_by_stage"
                            string="Stage" context="{'group_by': 'stage_id'}"/> -->
                    <filter context="{'group_by': 'stage_type_id'}" name="filter_group_by_stage_type" string="Stage Type"/>
                    <filter context="{'group_by': 'partner_id'}" name="filter_group_by_partner" string="Partner"/>
                    <filter context="{'group_by': 'user_id'}" name="filter_group_by_assignee" string="Assignee"/>
                    <filter context="{'group_by': 'is_assigned'}" name="filter_group_by_is_assigned" string="Is assigned"/>
                    <filter context="{'group_by': 'author_id'}" name="filter_group_by_author" string="Author"/>
                    <filter context="{'group_by': 'created_by_id'}" name="filter_group_by_created_by" string="Created by"/>
                    <filter context="{'group_by': 'closed'}" name="filter_group_by_is_closed" string="Is closed"/>
                    <filter context="{'group_by': 'closed_by_id'}" name="filter_group_by_closed_by" string="Closed by"/>
                    <filter context="{'group_by': 'priority'}" name="filter_group_by_priority" string="Priority"/>
                    <filter context="{'group_by': 'channel_id'}" name="filter_group_by_channel" string="Channel"/>
                    <filter context="{'group_by': 'submission_instance'}" domain="[]" name="filter_group_by_instance" string="Instance"/>
                </group>
            </search></field>
    </record>
    <record id="view_request_request_graph" model="ir.ui.view">
        <field name="model">request.request</field>
        <field name="arch" type="xml">
            <graph>
                <field name="type_id"/>
                <field name="stage_type_id"/>
            </graph></field>
    </record>
    <record id="view_request_request_pivot" model="ir.ui.view">
        <field name="model">request.request</field>
        <field name="arch" type="xml">
            <pivot>
                <field name="stage_type_id" type="col"/>
                <field name="kind_id" type="row"/>
                <field name="type_id" type="row"/>
            </pivot></field>
    </record>
    <record id="action_stat_request_count" model="ir.actions.act_window">
        <field name="name">Request Count</field>
        <field name="res_model">request.request</field>
        <field name="view_mode">kanban,tree,graph,pivot,form,activity</field>
    </record>
    <record id="view_request_request_searchpanel" model="ir.ui.view">
        <field name="model">request.request</field>
        <field name="inherit_id" ref="view_request_request_search"/>
<!--        <field eval="[(4, ref('group_request_show_searchpanel_view'))]" name="groups_id"/>-->
        <field name="arch" type="xml">
            <xpath expr="/search/group" position="before">
                <searchpanel>
                    <field name="category_id" string="Category"/>
                    <field name="type_id" string="Type"/>
                    <field name="stage_type_id" string="Stage Type"/>
                    <field domain="[('model_id.model', '=', 'request.request')]" name="tag_ids" select="multi" string="Tags"/>
                    <field name="channel_id" string="Channel"/>
                </searchpanel>
            </xpath></field>
    </record>
</odoo>
